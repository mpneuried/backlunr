/**
 * backlunr - is a solution to bring Backbone Collections together with the browser fulltext search engine Lunr.js
 * @version v0.2.3
 * @link https://github.com/mpneuried/backlunr
 * @license MIT
 */
(function(){var t=function(t,n){return function(){return t.apply(n,arguments)}},n=function(t,n){function r(){this.constructor=t}for(var e in n)i.call(n,e)&&(t[e]=n[e]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},i={}.hasOwnProperty;Backbone.Collection.Lunr=function(i){function r(n,i){this.search=t(this.search,this),this._lunrExtractData=t(this._lunrExtractData,this),this.reset=t(this.reset,this),this._lunrChange=t(this._lunrChange,this),this._lunrRemove=t(this._lunrRemove,this),this._lunrAdd=t(this._lunrAdd,this),this._lunrInitialize=t(this._lunrInitialize,this),r.__super__.constructor.call(this,n,i),this._lunrInitialized=!1,this.on("add",this._lunrAdd),this.on("remove",this._lunrRemove),this.on("change",this._lunrChange)}return n(r,i),r.prototype.lunroptions={fields:[]},r.prototype._lunrInitialize=function(t){var n;return null==t&&(t=!1),t||!this._lunrInitialized?(n=this,n._lunrFields=[],this._lunrIndex=lunr(function(){var t,i,r,e,s,o,l,u,h;for(t=_.isFunction(n.lunroptions)?n.lunroptions(opt):_.extend({},n.lunroptions||(n.lunroptions={})),this.ref("cid"),u=t.fields,r=0,s=u.length;s>r;r++)i=u[r],n._lunrFields.push(i.name),this.field(i.name,_.omit(i,["isID","name"]));for(h=n.models,e=0,o=h.length;o>e;e++)l=h[e],this.add(n._lunrExtractData(l))}),this._lunrInitialized=!0,this):void 0},r.prototype._lunrAdd=function(t){this._lunrInitialize(),this._lunrIndex.add(this._lunrExtractData(t))},r.prototype._lunrRemove=function(t){var n;this._lunrInitialize(),n=t.toJSON(),n.cid=t.cid,this._lunrIndex.remove(n)},r.prototype._lunrChange=function(t){this._lunrInitialize(),this._lunrIndex.update(this._lunrExtractData(t))},r.prototype.reset=function(t,n){var i,e,s,o;for(r.__super__.reset.call(this,t,n),this._lunrInitialize(!0),o=this.models,i=0,e=o.length;e>i;i++)s=o[i],this._lunrAdd(s);return this},r.prototype._lunrExtractData=function(t){var n,i,r,e,s;for(n=t.toJSON(),n.cid=t.cid,s=this._lunrFields,r=0,e=s.length;e>r;r++)i=s[r],null==n[i]?n[i]="":n[i]=n[i].toString();return n},r.prototype.processTerm=function(t){return t},r.prototype.search=function(t,n){var i,r,e,s;return null==n&&(n=!1),this._lunrInitialize(),i=this._lunrIndex.search(this.processTerm(t)),n?i:(r=function(){var t,n,r;for(r=[],e=t=0,n=i.length;n>t;e=++t)s=i[e],r.push(this.get(s.ref));return r}.call(this),r.toJSON=function(t){var n,i;return n=function(){var n,r,e;for(e=[],n=0,r=this.length;r>n;n++)i=this[n],e.push(i.toJSON(t));return e}.call(this)},r)},r}(Backbone.Collection)}).call(this);